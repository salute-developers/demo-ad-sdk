
# SberDevices Ad Video SDK

## Установка

Подключите показывающий код через тег script в ваше приложение:

```html
    <script src="https://cdn-app.sberdevices.ru/shared-static/0.0.0/js/@sberdevices/video-ad-sdk/video-ad-sdk-0.2.0.min.js"></script>
```

## Использование

После загрузки скрипта вам будет доступен объект `window.SberDevicesVideoAdSDK`;
У этого объекта есть два метода:

- `init()`
- `run()`

### Инициализация

Для корректной инициализации показывающего кода, необходимо передать следующие параметры:

```js
init({
    sub: '42l/Y1...', // sub пользователя
    projectName: 'y2dw...', // идентификатор проекта
    device: { ... }, // информация об устройстве пользователя
    app_info: { ... }, // информация о приложении
})
```

Всю эту информацию необходимо получить c помощью ассистента; Для этого необходимо установить модуль для общения с ассистентом: [assistant-client](https://github.com/sberdevices/assistant-client#%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0)

И написать базовый сценарий для передачи этой информации, [пример такого сценария](./api/hook.js) расположени в этом репозитории;
Пример написан с использованием фреймворка [SaluteJS](https://github.com/sberdevices/salutejs)
Вы можете написать сценарий с использованием любого другого [инструмента](https://developers.sber.ru/docs/ru/salute/overview#%D0%B8%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D1%8B)

### Запуск рекламы

После инициализации показывающего кода, необходимо воспользоваться командой `run()`, для показа видео-рекламы.

```js
run({
    onSuccess: () => {}, // Вызовется при переходе или при полном показе рекламы
    onError: () => {}, // Вызовется во время ошибки при показе рекламы
});
```

[Пример](./src/index.js) для запуска рекламы также расположен в данном репозитории.

## Запуск демо проекта

Перед началом работы создайте свой смартапп(canvas) в [студии](https://smartapp-studio.sberdevices.ru/)

и скопируйте `.env.sample` в `.env`. Заполните необходимые переменные.

Демо проект использует [vercel](https://vercel.com/) для поднятия локального сервера разработки;

```
npm ci 
npm start
```

После запуска поднимите тунель например с помощью `ngrok` на порт 3000 и пропишите в созданном ранее смартапе пути до тунеля:
 - Webhook смартапа: туннель+/api/hook
 - Frontend Endpoint: туннель

